{% extends 'base.html' %}
{% block title %}Discussion - {{ thread.title }}{% endblock %}

{% block content %}
<h2>📌 {{ thread.title }}</h2>
<p><strong>Started by:</strong> {{ thread.created_by.username }} | {{ thread.created_at|date:"Y-m-d H:i" }}</p>

<hr>

<div>
  {% for msg in messages %}
    <div style="margin-bottom: 15px;">
      <p><strong>{{ msg.posted_by.username }}</strong>:</p>
      <div style="margin-left: 10px; padding: 8px; background-color: #f1f1f1; border-radius: 5px;">
        {{ msg.content|linebreaks }} <br>
        <small>Posted at {{ msg.created_at|date:"Y-m-d H:i" }}</small>
      </div>

      {% if user == msg.posted_by %}
        <div style="margin-left: 10px;">
          <a href="{% url 'edit_message' msg.id %}">✏️ Edit</a> |
          <a href="{% url 'delete_message' msg.id %}" onclick="return confirm('Are you sure you want to delete this message?');">🗑️ Delete</a>
        </div>
      {% endif %}
    </div>
    <hr>
  {% empty %}
    <p>No messages in this thread yet.</p>
  {% endfor %}
</div>

<h3>💬 Post a Reply</h3>
<form method="post">
  {% csrf_token %}
  {{ form.as_p }}
  <button type="submit">Post Reply</button>
</form>
{% endblock %}
